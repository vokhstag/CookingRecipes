# CookingRecipes

### Приложение рецептов.

Приложение показывает рецепты блюд по категориям. Для использования необходимо зарегистрироваться.
Регистрация локальная, реализованна на Core Data. Каждый пользователь может добавлять блюда в избранное, и они будут сохранены в Core Data и доступны оффлайн.

---

__Данные для приложения берутся из https://www.themealdb.com__

[__Ссылка на черновик карты экранов__](https://www.figma.com/file/nE5BM1rhnuqGtXYl4VS6uL/RecipeApp?node-id=0%3A1)

##### Модели данных:
__1. Модель блюда:__
```
         "idMeal":Int,
         "strMeal": String,
         "strDrinkAlternate": String?,
         "strCategory": String,
         "strArea": String,
         "strInstructions": String,
         "strMealThumb": String?,
         "strTags": String?,
         "strYoutube": String?,
         "strIngredient1": String?,
         "strIngredient2": String?,
         "strIngredient3": String?,
         "strIngredient4": String?,
         "strIngredient5": String?,
         "strIngredient6": String?,
         "strIngredient7": String?,
         "strMeasure1": String?,
         "strMeasure2": String?,
         "strMeasure3": String?,
         "strMeasure4": String?,
         "strMeasure5": String?,
         "strMeasure6": String?,
         "strMeasure7": String?,
```
__2. Модель категорий:__
```
         "idCategory": Int,
         "strCategory": String,
         "strCategoryThumb": String?,
         "strCategoryDescription": String?
```
__3. Модель профиля пользователя:__
```
        "userId": Int,
        "userName": String,
        "login": String,
        "password": String,
        "isActive": Bool
```
---
### Архитектура
В качестве архитектуры выбрал MVP
Для навигации использую Router вместе с AssemblyBuilder который отвечает за создание и инициализацию view.
Для доступа к сети создал несколько нетворк сервисов (следуя принципу ISP из SOLID) для каждого контроллера.
Тоже самое сделал для DataManager.
Для удобства тестирования инициализацию делал через DI, а также применял принцип DIP из Solid

---
### Экраны
#### Экран Регистрации
Регистрация представляет из себя добавление объекта User в CoreData и установка его значения isActive в true
После загрузки приложения делается запрос в базу и проверяется есть ли в базе объект User со значением isActive = true, если нету, то презентится экран регистрации.
После регистрации экран закрывается и показывается главный экран.
#### Главный экран
Главный экран представляет из себя 2 контроллера - Container и content. 
Container содержит collection view который отображает все категории блюд. 
Список категорий по запросу приходит с бека.
После получения категорий в презентер Content контроллера приходит уведомление (через делегат) о том какую категорию блюд показать (тоже ссамое происходит и при выделении новой категории)
Информация о том какая категория является активной при загрузке мы узнаем из UserDefaults (то, что в последний раз последним выделял пользователь), если этой информации нет, то берется категория под индексом 0.
При поиске блюд такая же логика, но передается текст по которому нужно искать и презентер Content контроллера делает запрос.
При тапе на ячейку с блюдом выполняется переход на DetailController, и ему передается модель блюда, кототое нужно отобразить.
#### DetailViewController
DetailViewController представляет из себя tableView, с различными ячейками (для фото и имени, для инструкции, для отображения ингредиентов)
В этом контроллере можно добавить блюдо в/из избранное, и оно сохранится в CoreData в списке избранных блюд активного Юзера (также можно и удалить). 
При тапе на ингредиент можно в present controller увидеть увеличенное фото и описание ингредиента.
#### IngredientViewController
Контроллер получает от DetailViewController информацию об ингредиенте и отображает его.
#### Экран FavoriteFood
Экран с Collection View
При переходе на этот экран делается запрос в базу, для получения всех сохраненных блюд для активного юзера, после чего полученные данные отображаются.
При тапе на ячейку также роисходит переход в DetailViewController, где можно удалить это блюдо. 
Т.к. DetailViewController требует на входе модель данных полученную из сети, в классе coreData, в котором сохраняется избранное добавлен метод преобразующий этот класс в структуру которую мы получаем из сети.





